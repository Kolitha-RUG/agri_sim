<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <title>Vineyard Live Animation</title>
  </head>
  <body style="margin:0; overflow:hidden;">
    <script>
      let data = {workers: [], drones: [], collection_points: []};

      function setup() {
        createCanvas(800, 500);
        background(230, 255, 230);
        textSize(16);
      }

      function draw() {
        background(230, 255, 230);
        fill('green');
        data.collection_points.forEach(cp => {
          rect(cp.x * 40, height - cp.y * 40, 15, 15);
        });
        fill('red');
        data.workers.forEach(w => {
          ellipse(w.x * 40, height - w.y * 40, 15, 15);
        });
        fill('blue');
        data.drones.forEach(d => {
          ellipse(d.x * 40, height - d.y * 40, 20, 20);
        });
        fill(0);
        text("Time: " + (data.time || 0).toFixed(2), 10, 20);
      }

      // Function to receive updates from Python
      window.updateData = (jsonData) => {
        data = JSON.parse(jsonData);
      };
    </script>
  </body>
</html>
